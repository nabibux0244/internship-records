<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Internship Records</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
  input, button { padding: 10px; margin: 5px 0; width: 100%; max-width: 400px; }
  .card { border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 10px; }
</style>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<h2>Internship Records</h2>

<input type="file" id="fileInput" accept=".xlsx,.xls">
<input type="text" id="searchInput" placeholder="Search by name, phone, email, role">
<button id="searchBtn">Search</button>
<div id="records"></div>

<script>
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const recordsCol = db.collection('records');

  let allRecords = [];

  document.getElementById('fileInput').addEventListener('change', handleFile);
  document.getElementById('searchBtn').addEventListener('click', searchRecords);

  function handleFile(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = (evt) => {
      const data = evt.target.result;
      const workbook = XLSX.read(data, { type: 'binary' });
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const jsonData = XLSX.utils.sheet_to_json(sheet);

      jsonData.forEach(record => recordsCol.add(record));
      fetchRecords();
    };
    reader.readAsBinaryString(file);
  }

  function fetchRecords() {
    recordsCol.get().then(snapshot => {
      allRecords = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      displayRecords(allRecords);
    });
  }

  function displayRecords(records) {
    const container = document.getElementById('records');
    container.innerHTML = '';
    records.forEach(rec => {
      const card = document.createElement('div');
      card.className = 'card';
      card.innerHTML = `
        <strong>${rec['Full Name'] || 'Candidate'}</strong><br>
        Phone: ${rec['Phone'] || ''}<br>
        Email: ${rec['Email'] || ''}<br>
        Role: ${rec['Role'] || ''}
      `;
      container.appendChild(card);
    });
  }

  function searchRecords() {
    const query = document.getElementById('searchInput').value.toLowerCase();
    const filtered = allRecords.filter(rec =>
      Object.values(rec).some(val => val?.toString().toLowerCase().includes(query))
    );
    displayRecords(filtered);
  }

  fetchRecords();
</script>

</body>
</html>